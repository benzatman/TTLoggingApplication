{% extends "base.html" %}

{% block title %}Director Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h2>Welcome, Director {{ current_user.username }}</h2>

    <!-- Unanswered Requests Section -->
    <h3>Unanswered Requests</h3>
    <ul>
        {% for request in unanswered_requests %}
        <li>
            <strong>{{ request.student.username }}</strong> requested a {{ request.request_type }}:
            <p>{{ request.details }}</p>
            <form method="POST" action="{{ url_for('approve_request', request_id=request.id) }}">
                <textarea name="message" placeholder="Leave a message (optional)" class="form-control"></textarea>
                <button name="action" value="approve" class="btn btn-success">Approve</button>
                <button name="action" value="reject" class="btn btn-danger">Reject</button>
            </form>
        </li>
        {% endfor %}
    </ul>

    <!-- Log an Absence Section -->
    <h3>Log an Absence</h3>
    <form method="POST" action="{{ url_for('log_absence') }}">
        {{ absence_form.hidden_tag() }}
        <div class="form-group">
            {{ absence_form.student_id.label }}
            {{ absence_form.student_id(class="form-control") }}
        </div>
        <div class="form-group">
            {{ absence_form.absence_type.label }}
            {{ absence_form.absence_type(class="form-control") }}
        </div>
        <div class="form-group">
            {{ absence_form.reason.label }}
            {{ absence_form.reason(class="form-control") }}
        </div>
        <div class="form-group">
            {{ absence_form.submit(class="btn btn-primary") }}
        </div>
    </form>

    <!-- Manage Users Section -->
    <h3>Manage Users</h3>
    <form method="POST" action="{{ url_for('manage_users') }}">
        <div class="form-group">
            <label for="username">Username</label>
            <input type="text" name="username" placeholder="Username" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" name="password" placeholder="Password" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="phone_number">Phone Number</label>
            <input type="text" name="phone_number" placeholder="Phone Number" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="role">Role</label>
            <select name="role" class="form-control" required>
                <option value="1">Student (1)</option>
                <option value="2">Counselor (2)</option>
                <option value="3">Director (3)</option>
            </select>
        </div>
        <div class="form-group">
            <input type="submit" name="add_user" value="Add User" class="btn btn-primary">
            <input type="submit" name="delete_user" value="Delete User" class="btn btn-danger">
        </div>
    </form>

    <!-- View Statistics Section -->
    <h3>View Statistics</h3>
    <form method="POST" action="{{ url_for('statistics') }}">
        <div class="form-group">
            <label for="username">Search by Student Username</label>
            <input type="text" name="username" placeholder="Enter Student Username" class="form-control">
        </div>
        <div class="form-group">
            <input type="submit" value="Search" class="btn btn-info">
        </div>
    </form>
</div>
{% endblock %}
